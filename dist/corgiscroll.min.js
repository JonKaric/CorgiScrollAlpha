!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).CorgiScroll=i()}(this,(function(){"use strict";function t(t){let i=t.events;return{on:(t,e)=>{"object"!=typeof i[t]&&(i[t]=[]),i[t].push(e)},emit:(t,...e)=>{"object"==typeof i[t]&&i[t].forEach((t=>{t.apply(null,e)}))}}}function i(i,e,n){const o=t(i),{on:s,emit:l}=o;let r=0,a=i.slideContainer.getBoundingClientRect();const d=(t,e)=>t.reduce(((t,n)=>(console.log(`Goal: ${e}`),console.log("Max Left Size: "+(i.slideContainer.scrollWidth-a.width)),e>=i.slideContainer.scrollWidth-a.width||n<=e?n:t))),c=()=>d(n.slides.map((t=>t.snapPoint)),Math.ceil(i.slideContainer.scrollLeft));function h(){!function(){if(0==n.slides.length)return void(n.el=null);const t=document.createElement("div");t.classList.add("corgiscroll-pagination");const e=Array.from(n.slides).findIndex((t=>t.snapPoint===c()));r=e;const o=`\n            ${n.slides.map(((t,i)=>i===r?`<button class="corgiscroll__pagination-dot active" data-index="${i}"><span class="">${i}</span></button>`:`<button class="corgiscroll__pagination-dot" data-index="${i}"><span class="">${i}</span></button>`)).join("")}\n        `;t.innerHTML=o,n.el=t,i.slideContainer.after(t),l("update_active",r)}(),n.el&&n.el.addEventListener("click",u)}function u(t){const e=t.target;e.getAttribute("data-index")&&i.go(parseInt(e.getAttribute("data-index")))}h(),s("scroll",(()=>{if(null===n.el)return;const t=Array.from(n.slides).findIndex((t=>t.snapPoint===c()));l("update_active",t)})),s("update_active",(t=>{i.pagination.el.children[r].classList.remove("active"),i.pagination.el.children[t].classList.add("active"),r=t})),s("refresh",(()=>{null!=n.el&&(i.pagination.el.removeEventListener("click",u),i.pagination.el.remove()),h()}))}function e(t,i){return{init:()=>{!function(){let e=document.createElement("div");e.classList.add("corgiscroll__arrows");const n=`\n            <button class="corgiscroll__arrow corgiscroll__arrow--left">\n                ${i.arrowLeftHtml}\n            </button>\n            <button class="corgiscroll__arrow corgiscroll__arrow--right">\n                ${i.arrowRightHtml}\n            </button>\n        `;e.innerHTML=n,t.slideContainer.after(e)}(),t.root.querySelector(".corgiscroll__arrow--left").addEventListener("click",(()=>{t.prev()})),t.root.querySelector(".corgiscroll__arrow--right").addEventListener("click",(()=>{t.next()}))}}}function n(t,i,e){let n=[],o=0,s=0;const l=i.snapType,r=e.getBoundingClientRect();console.log(r);const a=t=>{const i=getComputedStyle(t);return parseInt(i.getPropertyValue("margin-left"))+parseInt(i.getPropertyValue("margin-left"))+t.getBoundingClientRect().width},d=(t,i)=>{const n=t.getBoundingClientRect();return 0===i?0:"center"===l?Math.ceil(n.x-r.x-r.width/2):"start"===l?Math.ceil(n.x-r.x+e.scrollLeft):null},c=()=>Math.ceil(t.slideContainer.scrollWidth-r.width);return"slide"===t.options.mode?function(){let t=0;Array.from(e.children).forEach(((i,l)=>{if(o<e.scrollWidth-r.width||o<c()){if(o>c()&&o-t<c())return console.log(n),void(n[n.length-1].snapPoint=c());s++,o+=a(i),t=a(i),n.push({el:i,snapPoint:d(i,l)})}else{if(console.log("hitting here"),o+=a(i),!n.length||o>c())return;if(c()===n[l-1].snapPoint)return;n.push({el:i,snapPoint:c()})}}))}():Array.from(e.children).forEach(((t,i)=>{o+=a(t),(o>(()=>{let t=0;return"center"===l?t=0===s?r.width/2:r.width:"start"===l&&(t=r.width),Math.ceil(t)})()||0===i)&&(s++,o=a(t),n.push({el:t,snapPoint:d(t,i)}))})),console.log(n),n}return class{root;slideContainer;rootBounds={};options={};pagination;windowWidth;events={};active;on;emit;constructor(i,o){this.root=i,this.slideContainer=this.root.children[0],this.rootBounds=this.slideContainer.getBoundingClientRect(),this.windowWidth=window.innerWidth,this.active=0;const s={root:this.root,rootBounds:this.rootBounds,style:"dot",type:"page",snapType:getComputedStyle(this.root.children[0].children[0]).getPropertyValue("scroll-snap-align"),arrowLeftHtml:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><g><line x1="13.5" y1="7" x2="0.5" y2="7" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"></line><polyline points="4 3.5 0.5 7 4 10.5" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"></polyline></g></svg>',arrowRightHtml:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><g><line x1="0.5" y1="7" x2="13.5" y2="7" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"></line><polyline points="10 10.5 13.5 7 10 3.5" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"></polyline></g></svg>'};this.options=Object.assign(s,o),this.pagination={el:null,slides:n(this,this.options,this.slideContainer)};const l=t(this);this.on=l.on,this.emit=l.emit,o.arrows&&e(this,this.options).init(),this.init()}init(){this.initialiseSlideClasses(),window.addEventListener("resize",this.emit("resized")),window.addEventListener("resize",this.handleResize),this.slideContainer.addEventListener("scroll",(()=>{this.emit("scroll")})),i(this,this.options,this.pagination)}go(t){this.slideContainer.scrollTo({top:0,left:(t=>this.pagination.slides[t].snapPoint)(t),behavior:"smooth"}),this.updateActive(t)}next(){this.active+1>=this.pagination.slides.length||this.go(this.active+1)}prev(){this.active-1<0||this.go(this.active-1)}updateActive(t){this.active=t}handleResize=function(t,i){let e=null;return(...n)=>{window.clearTimeout(e),e=window.setTimeout((()=>{t.apply(null,n)}),i)}}((()=>{(this.windowWidth<window.innerWidth||this.windowWidth>window.innerWidth)&&(this.windowWidth=window.innerWidth,this.pagination.slides=n(this,this.options,this.slideContainer),this.emit("refresh"),this.emit("resize"))}),500);initialiseSlideClasses(){Array.from(this.slideContainer.children).forEach(((t,i)=>{let e=t.getBoundingClientRect();t.setAttribute("data-slide",i.toString()),t.setAttribute("data-position",e.x.toString())}))}}}));
